<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WinTrim.Avalonia.Views"
        mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="550"
        x:Class="WinTrim.Avalonia.Views.QuickCleanDialog"
        x:DataType="local:QuickCleanDialog"
        Title="Quick Clean - Select Items"
        Width="700" Height="550"
        MinWidth="500" MinHeight="400"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        CanResize="True">
    
    <Grid Margin="16" RowDefinitions="Auto,Auto,*,Auto,Auto">
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,12">
            <TextBlock Text="ðŸ§¹ Select Items to Clean" 
                       FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource TextPrimaryBrush}"/>
            <TextBlock Text="Check the items you want to remove. Expand categories to select individual files."
                       Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,0"/>
        </StackPanel>
        
        <!-- Select All / None Buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,8">
            <Button Content="âœ“ Select All" Click="SelectAll_Click" 
                    Padding="12,6" Margin="0,0,8,0"
                    Background="{DynamicResource SurfaceBrush}"
                    Foreground="{DynamicResource TextPrimaryBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"/>
            <Button Content="âœ— Select None" Click="SelectNone_Click" 
                    Padding="12,6"
                    Background="{DynamicResource SurfaceBrush}"
                    Foreground="{DynamicResource TextPrimaryBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"/>
            <Button Content="âŠ• Expand All" Click="ExpandAll_Click" 
                    Padding="12,6" Margin="16,0,8,0"
                    Background="{DynamicResource SurfaceBrush}"
                    Foreground="{DynamicResource TextPrimaryBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"/>
            <Button Content="âŠ– Collapse All" Click="CollapseAll_Click" 
                    Padding="12,6"
                    Background="{DynamicResource SurfaceBrush}"
                    Foreground="{DynamicResource TextPrimaryBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"/>
        </StackPanel>
        
        <!-- Items List -->
        <Border Grid.Row="2" BorderBrush="{DynamicResource BorderBrush}" 
                BorderThickness="1" CornerRadius="4" Background="{DynamicResource SurfaceBrush}">
            <ScrollViewer>
                <ItemsControl x:Name="ItemsContainer" Margin="8">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="local:SelectableCleanupCategory">
                            <Border Margin="0,4" Padding="8" CornerRadius="4"
                                    Background="{DynamicResource BackgroundBrush}">
                                <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                                    <CheckBox Grid.Column="0" IsChecked="{Binding IsSelected}" 
                                              VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Description}" 
                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                   FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="{Binding Path}" 
                                                   Foreground="{DynamicResource TextMutedBrush}"
                                                   FontSize="11" TextTrimming="CharacterEllipsis"
                                                   MaxWidth="350"/>
                                    </StackPanel>
                                    
                                    <TextBlock Grid.Column="2" Text="{Binding FileCountText}" 
                                               Foreground="{DynamicResource TextMutedBrush}"
                                               VerticalAlignment="Center" Margin="12,0"
                                               FontSize="11"/>
                                    
                                    <TextBlock Grid.Column="3" Text="{Binding SavingsFormatted}" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               VerticalAlignment="Center" Margin="8,0"
                                               FontWeight="Medium"/>
                                    
                                    <TextBlock Grid.Column="4" Text="{Binding RiskLevelText}" 
                                               VerticalAlignment="Center" Width="40"
                                               FontWeight="Medium" FontSize="11"
                                               Foreground="{Binding RiskLevelColor}"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>
        
        <!-- Summary -->
        <Border Grid.Row="3" Background="{DynamicResource BackgroundBrush}" 
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                CornerRadius="4" Padding="12" Margin="0,12,0,0">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Selected: " Foreground="{DynamicResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="SelectedCountText" Text="0 categories" 
                               Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="Medium"/>
                    <TextBlock Text=" â€¢ Space to recover: " Foreground="{DynamicResource TextSecondaryBrush}" Margin="16,0,0,0"/>
                    <TextBlock x:Name="SelectedSizeText" Text="0 B" 
                               Foreground="#10B981" FontWeight="Bold" FontSize="14"/>
                </StackPanel>
                
                <TextBlock Grid.Column="1" x:Name="SelectedFilesText" Text="0 files"
                           Foreground="{DynamicResource TextMutedBrush}" FontSize="11"/>
            </Grid>
        </Border>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" 
                    HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Cancel" Click="Cancel_Click" 
                    Padding="20,10" Margin="0,0,8,0"
                    Background="{DynamicResource SurfaceBrush}"
                    Foreground="{DynamicResource TextPrimaryBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"/>
            <Button x:Name="CleanButton" Content="ðŸ§¹ Clean Selected" Click="Clean_Click" 
                    Padding="20,10"
                    Background="#4CAF50"
                    Foreground="White"
                    BorderThickness="0"
                    FontWeight="SemiBold"/>
        </StackPanel>
    </Grid>
</Window>
